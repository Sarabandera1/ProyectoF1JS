<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="css/form-pilotos.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registro de Piloto</title>
</head>

<body class="background">
  <div class="card">
    <div class="card-header">
      <h2>Registro de Piloto</h2>
    </div>
    <form id="formCrearPiloto">
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label" for="nombrePiloto">Nombre del Piloto</label>
          <input type="text" class="form-control" id="nombrePiloto" name="nombrePiloto" placeholder="Ingrese el nombre del piloto" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="edadPiloto">Edad</label>
          <input type="number" class="form-control" id="edadPiloto" name="edadPiloto" placeholder="Ingrese la edad del piloto" required>
        </div>
        <div class="form-group">
          <label class="form-label" for="paisPiloto">Pa√≠s</label>
          <input type="text" class="form-control" id="paisPiloto" name="paisPiloto" placeholder="Ingrese el pa√≠s del piloto" required>
        </div>
        <div class="form-group">
          <label for="equipoPiloto" class="form-label">Equipo</label>
          <select class="form-control" name="equipoPiloto" id="equipoPiloto" required>
            <option value="">Seleccionar Equipo</option>
            <!-- Aqu√≠ puedes a√±adir opciones din√°micamente con JavaScript -->
          </select>
        </div>
        <div class="form-group">
          <label class="form-label" for="imagenPiloto">Imagen del Piloto</label>
          <div class="image-upload-container" id="dropZonePiloto">
            <i>üìÅ</i>
            <p class="image-upload-text">Arrastra una imagen aqu√≠ o haz clic para seleccionar</p>
            <input type="file" class="file-input" id="imagenPiloto" name="imagenPiloto" accept="image/*" required>
          </div>
          <div class="preview-container">
            <img class="preview-image" id="imagePreviewPiloto" alt="Preview">
          </div>
        </div>
      </div>
      <button id="btnRegistrarPiloto" type="submit" class="btn-submit">Registrar Piloto</button>
      <div id="statusMessagePiloto" class="status-message"></div>
    </form>
  </div>
          <script>
            const form = document.getElementById('formCrearPiloto');
            const statusMessage = document.getElementById('statusMessagePiloto');
          
            form.addEventListener('submit', async (event) => {
              event.preventDefault();
          
              const formData = new FormData(form); // Crear un objeto FormData con los datos del formulario
          
              try {
                const response = await fetch('http://localhost:3000/api/pilotos', {
                  method: 'POST',
                  body: formData,
                });
          
                if (response.ok) {
                  const data = await response.json();
                  statusMessage.textContent = data.message;
                  statusMessage.style.color = 'green';
                  form.reset();
                  document.getElementById('imagePreviewPiloto').src = ''; // Limpiar la vista previa
                } else {
                  const errorData = await response.json();
                  statusMessage.textContent = errorData.message || 'Error al registrar piloto';
                  statusMessage.style.color = 'red';
                }
              } catch (error) {
                console.error('Error:', error);
                statusMessage.textContent = 'Error al conectar con el servidor';
                statusMessage.style.color = 'red';
              }
            });
          
            // Previsualizaci√≥n de la imagen cargada
            const fileInput = document.getElementById('imagenPiloto');
            const previewImage = document.getElementById('imagePreviewPiloto');
          
            fileInput.addEventListener('change', (event) => {
              const file = event.target.files[0];
              if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                  previewImage.src = e.target.result; // Mostrar vista previa de la imagen
                };
                reader.readAsDataURL(file);
              }
            });
          </script>
</body>

</html>
